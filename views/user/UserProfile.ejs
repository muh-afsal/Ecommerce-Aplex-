<%-include("./partials/header.ejs")%>
    <title>User Profile</title>
    <style>
        .profile_container {
            height: 77vh;
            background-color: #dfecff;

            display: flex;
            justify-content: center;
            flex-direction: row;
        }



        .side_nav_container {
            width: 40%;
            height: auto;
            display: flex;
            justify-content: center;
            align-items: center;


        }

        .userDetails_container {
            margin-left: 53px;
            width: 56vw;
            background-color: white;
            height: auto;
            margin-bottom: 21px;
            margin-top: 23px;
            border-radius: 11px;
            box-shadow: rgba(0, 0, 0, 0.1) 0px -4px 16px 0px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px;
        }

        .profile_img_container {
            height: 28vh;
            /* background-color: darkgray; */
            padding: 20px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            border-bottom: 0.5px solid;
        }

        .profile_info_container {
            height: 40vh;
            /* background-color: coral; */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 30px;

        }

        #profile_image {
            height: 12vw;
            width: 24vh;
            /* background-color: aquamarine; */
            border-radius: 50%;
            overflow: hidden;
            background-size: cover;
            background-position: center;
            box-shadow: rgba(0, 0, 0, 0.1) 0px -4px 16px 0px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px;


        }

        .input_text {
            width: 23vw;
            height: 45px;
            border-radius: 12px;
            border: none;
            outline: none;
            box-shadow: rgba(0, 0, 0, 0.1) 0px -4px 16px 0px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px;

        }

        .edit_btn {
            width: 13vw;
            height: 36px;
            border-radius: 12px;
            border: none;
            outline: none;
            color: white;
            background-color: #4461F2;
        }
        .custom-popover {
            color: rgb(255, 255, 255)!important;
        background-color: black!important;
    }
        .popover-body {
            color: rgb(255, 255, 255)!important;
    }
    </style>

    </head>

    <body>

        <%-include("./partials/nav-after-login.ejs")%>
            <div class="profile_container container-fluid">

                <div class="userDetails_container ">
                    <div class="profile_img_container">
                        <div id="profile_image"
                            style="background-size: contain; background-position: center; background-image: url(/profile-images/<%=userData.profileImage%>);">

                        </div>
                        <h3 style="margin-top: 100px;font-weight: 700;">Muhammed Afsal <br>
                            <p style="font-size: smaller;margin-top: 10px; color: #0000006b;"> Your account is ready,
                                you can now apply for advice.</p>
                        </h3>

                    </div>
                    <div class="profile_info_container">
                        <div style="display: flex; gap: 40px;">
                            <input type="text" class="input_text " style="padding-left: 20px;"
                                value="<%=userData.username%>" readonly>
                            <input type="text" class="input_text" style="padding-left: 20px;"
                                value="<%=userData.email%>" readonly>

                        </div>
                        <div style="display: flex; gap: 40px;">
                            <input type="text" class="input_text" style="padding-left: 20px;"
                                value="<%=userData.phone%>" readonly>

                           
                             
                               <%if(userData.ReferalID){%>
                                  <button type="button" class=" input_text" data-toggle="modal"  style="padding-left: 20px; outline: none; cursor: pointer; display: flex;align-items: center; border: none; background-color: rgb(255, 255, 255);" data-target="#exampleModal">
                                    Referal ID
                                  </button>
                                  <%}%>
                                  
                                  <!-- Modal -->
                                  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog" role="document">
                                      <div class="modal-content">
                                        <div class="modal-header">
                                          <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                          </button>
                                        </div>
                                        <div class="modal-body">
                                            <span id="textToCopy">http://localhost:3000/signup?referalid=<%=userData.ReferalID%></span>
                                        </div>
                                        <div class="modal-footer">
                                          <!-- <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button> -->
                                          <button id="copyButton" type="button" onclick="copyToClipboard()" class="btn btn-primary"
        data-bs-toggle="popover" data-bs-placement="top" >
    Copy the code
</button>
                                        </div>
                                      </div>
                                    </div>
                                  </div>

                        </div>
                        <button onclick="navigateToeditprofile()" class="edit_btn">Edit</button>
                    </div>
                    <%-include("./partials/side-bar.ejs")%>


                </div>

            </div>
            <script>
                document.getElementById('openModalLink').addEventListener('click', function () {
                    $('#exampleModal').modal('show');
                });
            </script>
            <script>
                function navigateToeditprofile() {

                    window.location.href = "/editprofile"
                }




                function previewImage(inputid, imgID) {
                    const input = document.getElementById(inputid)
                    const img = document.getElementById(imgID)

                    if (input.files && input.files[0]) {
                        const reader = new FileReader();

                        reader.onload = function (e) {
                            img.src = e.target.result;
                        }
                        reader.readAsDataURL(input.files[0]);
                    } else {
                        img.src = "";
                    }
                }
            </script>
            <script>
                  function copyToClipboard() {
            // Get the text to copy
            var textToCopy = document.getElementById('textToCopy').innerText;

            // Use the Clipboard API to write to the clipboard
            navigator.clipboard.writeText(textToCopy)
                .then(function() {
                    var copyButton = document.getElementById('copyButton');
                var popover = new bootstrap.Popover(copyButton, {
                    trigger: 'manual',
                    placement: 'right',
                    content: 'Text copied to clipboard',
                    template: '<div class="popover custom-popover"  role="tooltip">' +
                        '<div class="popover-arrow"></div>' +
                        '<h3 class="popover-header"></h3>' +
                        '<div class="popover-body"></div>' +
                        '</div>'
                });
                popover.show();

                // Remove popover after 2 seconds
                setTimeout(function () {
                    popover.dispose();
                }, 2000);
            
                })
                .catch(function(err) {
                    console.error('Unable to copy text to clipboard', err);
                });
        }
            </script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous"></script>
        

            <%-include("./partials/footer.ejs")%>
                <%-include("./partials/footerlinks.ejs")%>